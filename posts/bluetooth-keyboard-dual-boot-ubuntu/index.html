<!doctype html><html lang=en-us><head><title>藍芽鍵盤於 Windows 和 Ubuntu 雙系統之配對與開機 // Ptzu's blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.81.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Roger Lin"><meta name=description content><link rel=stylesheet href=https://ptzu.github.io/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css><meta name=twitter:card content="summary"><meta name=twitter:title content="藍芽鍵盤於 Windows 和 Ubuntu 雙系統之配對與開機"><meta name=twitter:description content="前言 最近組了一台新電腦放到交大宿舍 不過位置有點小 所以採用了無線滑鼠和鍵盤 其中鍵盤是 Logitech K810 藍芽 其實如果都選 2.4GHz 的接收器鍵鼠, 就沒有這篇了ＸＤ 但是 K810 的造型實在太生火了 所以還是買了下去 這篇主要解決了以下問題:
 藍芽鍵盤無法在開機選單選擇系統 藍芽在切換系統後需要重新配對 切換系統後時間不一致  藍芽於 BIOS 由於藍芽必須在系統啟動後才能配對 所以在 BIOS 階段是無法使用的ＱＱ 在我的搜尋下有兩個解法 一是將 Ubuntu grub 改成可以用滑鼠選擇 這裡我找到了 Gujin bootloader 號稱 mouse support 的開機選單 不過套件有點久遠, 又一直 build 不起來 只好放棄了 二是使用 EasyBCD 替 Windows 製作多系統開機選單 這個流程是已經載入 Windows 了 所以可以使用藍芽鍵鼠進行選擇
系統背景 我的雙系統都是以 MBR 格式安裝的 並用 BIOS(Lagacy) 啟動 若是用 UEFI 的話不確定能否使用
還原 Windows bootloader 首先我是先安裝 Windows 再裝 Ubuntu Windows 的 bootloader 在 MBR 磁區會被蓋掉 所以我們開機的時候會是 grub 但是因為找不到 grub 的解法ＸＤ 所以我們必須再把 grub 蓋掉 這部分我們可以到 Windows 安裝畫面(CD or USB) 然後按修復電腦 -> 使用命令提示字元 接著切換到開機的磁區(C槽) 輸入指令"><meta property="og:title" content="藍芽鍵盤於 Windows 和 Ubuntu 雙系統之配對與開機"><meta property="og:description" content="前言 最近組了一台新電腦放到交大宿舍 不過位置有點小 所以採用了無線滑鼠和鍵盤 其中鍵盤是 Logitech K810 藍芽 其實如果都選 2.4GHz 的接收器鍵鼠, 就沒有這篇了ＸＤ 但是 K810 的造型實在太生火了 所以還是買了下去 這篇主要解決了以下問題:
 藍芽鍵盤無法在開機選單選擇系統 藍芽在切換系統後需要重新配對 切換系統後時間不一致  藍芽於 BIOS 由於藍芽必須在系統啟動後才能配對 所以在 BIOS 階段是無法使用的ＱＱ 在我的搜尋下有兩個解法 一是將 Ubuntu grub 改成可以用滑鼠選擇 這裡我找到了 Gujin bootloader 號稱 mouse support 的開機選單 不過套件有點久遠, 又一直 build 不起來 只好放棄了 二是使用 EasyBCD 替 Windows 製作多系統開機選單 這個流程是已經載入 Windows 了 所以可以使用藍芽鍵鼠進行選擇
系統背景 我的雙系統都是以 MBR 格式安裝的 並用 BIOS(Lagacy) 啟動 若是用 UEFI 的話不確定能否使用
還原 Windows bootloader 首先我是先安裝 Windows 再裝 Ubuntu Windows 的 bootloader 在 MBR 磁區會被蓋掉 所以我們開機的時候會是 grub 但是因為找不到 grub 的解法ＸＤ 所以我們必須再把 grub 蓋掉 這部分我們可以到 Windows 安裝畫面(CD or USB) 然後按修復電腦 -> 使用命令提示字元 接著切換到開機的磁區(C槽) 輸入指令"><meta property="og:type" content="article"><meta property="og:url" content="https://ptzu.github.io/posts/bluetooth-keyboard-dual-boot-ubuntu/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-09-11T21:25:58+00:00"><meta property="article:modified_time" content="2018-09-11T21:25:58+00:00"></head><body><header class=app-header><a href=https://ptzu.github.io/><img class=app-header-avatar src=/avatar.jpg alt="Roger Lin"></a><h1>Ptzu's blog</h1><nav class=app-header-menu><a class=app-header-menu-item href=/>Home</a>
-
<a class=app-header-menu-item href=/tags/>Tags</a>
-
<a class=app-header-menu-item href=/about/>About</a></nav><p>Record of My Life.</p><div class=app-header-social><a href=https://github.com/ptzu target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>My Github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>藍芽鍵盤於 Windows 和 Ubuntu 雙系統之配對與開機</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Sep 11, 2018</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>2 min read</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://ptzu.github.io/tags/linux/>Linux</a></div></div></header><div class=post-content><h1 id=前言>前言</h1><p>最近組了一台新電腦放到交大宿舍
不過位置有點小
所以採用了無線滑鼠和鍵盤
其中鍵盤是 Logitech K810 藍芽
<img src=https://i.imgur.com/xIy0Ek1.jpg alt=相當精緻質感的鍵盤>
其實如果都選 2.4GHz 的接收器鍵鼠, 就沒有這篇了ＸＤ
但是 K810 的造型實在太生火了
所以還是買了下去
這篇主要解決了以下問題:</p><ol><li>藍芽鍵盤無法在開機選單選擇系統</li><li>藍芽在切換系統後需要重新配對</li><li>切換系統後時間不一致</li></ol><h1 id=藍芽於-bios>藍芽於 BIOS</h1><p>由於藍芽必須在系統啟動後才能配對
所以在 BIOS 階段是無法使用的ＱＱ
在我的搜尋下有兩個解法
一是將 Ubuntu grub 改成可以用滑鼠選擇
這裡我找到了 Gujin bootloader
號稱 mouse support 的開機選單
不過套件有點久遠, 又一直 build 不起來
只好放棄了
二是使用 EasyBCD 替 Windows 製作多系統開機選單
這個流程是已經載入 Windows 了
所以可以使用藍芽鍵鼠進行選擇</p><h2 id=系統背景>系統背景</h2><p>我的雙系統都是以 MBR 格式安裝的
並用 BIOS(Lagacy) 啟動
若是用 UEFI 的話不確定能否使用</p><h2 id=還原-windows-bootloader>還原 Windows bootloader</h2><p>首先我是先安裝 Windows 再裝 Ubuntu
Windows 的 bootloader 在 MBR 磁區會被蓋掉
所以我們開機的時候會是 grub
但是因為找不到 grub 的解法ＸＤ
所以我們必須再把 grub 蓋掉
這部分我們可以到 Windows 安裝畫面(CD or USB)
然後按修復電腦 -> 使用命令提示字元
接著切換到開機的磁區(C槽)
輸入指令</p><pre><code>bootsect.exe /nt60 all /mbr
</code></pre><p>當出現 Successfully updated disk bootcode. 時就成功
接著重開機確認是否沒有出現 grub 了</p><h2 id=使用-easybcd>使用 EasyBCD</h2><p>下載好之後
如圖設定:
<img src=https://i.imgur.com/zeXkc2t.png alt>
再按加入項目
重新開機後
應該可以看到 Windows 選單
裡面包含剛剛加入的 Ubuntu 16.04</p><h1 id=藍芽重新配對>藍芽重新配對</h1><p>當藍芽和裝置配對時
電腦端會產生一組 key 存下來
鍵盤也會
而切到另一個系統的時候
再配對一次又會產生一組新的 key
導致切回去的時候 key 不相符
所以我們要做的是將兩個系統記載的 key 修改為一樣</p><p>首先在 Ubuntu 配對好之後
再到 Windows 配對
這時候鍵盤記錄的 key 是 Windows 的
然後我們想要把 Ubuntu 的 key 改成這個</p><ol><li>安裝 chntpw</li><li>在 Ubuntu 檔案系統中, 找到 Windows/System32/config 的路徑並開啟終端機</li><li>輸入 chntpw -e SYSTEM</li><li>cd ControlSet001\Services\BTHPORT\Parameters\Keys</li><li>ls</li><li>cd &ldquo;ls 出來的那個資料夾&rdquo;</li><li>ls</li><li>hex &ldquo;那個 value 得值&rdquo;</li><li>記好那一段 16 進位的字串(key)</li><li>到 /var/lib/bluetooth 連續進入兩個資料夾(16進位樣子的)</li><li>以管理員權限編輯 info</li><li>找到一段 [LinkKey] Key=0xXXXXXXXXXX 那裡換成剛剛記下來的 key</li><li>重新啟動就大功告成</li></ol><h1 id=系統時間不一致>系統時間不一致</h1><p>其實這和藍芽沒啥關係
順便解掉
在 Windows 中時間以 BIOS 顯示的時間為主
而在 Ubuntu 中以 UTC+8 為時間, 而他會把 BIOS 時間改成 UTC+0
這就是為什麼會到 Windows 時時間會慢 8 小時
解決方法是到 Ubuntu 禁用 UTC</p><pre><code>timedatectl set-local-rtc 1 --adjust-system-clock
</code></pre><h1 id=參考>參考</h1><ol><li><a href=https://blog.csdn.net/zbjdonald/article/details/45082399>https://blog.csdn.net/zbjdonald/article/details/45082399</a></li><li><a href=http://katsuno.pixnet.net/blog/post/264422257-%E7%A7%BB%E9%99%A4grub>http://katsuno.pixnet.net/blog/post/264422257-%E7%A7%BB%E9%99%A4grub</a></li><li><a href=https://www.zhihu.com/question/46525639>https://www.zhihu.com/question/46525639</a></li><li>查看 boot mode: <a href=http://www.rodsbooks.com/refind/bootmode.html#windows>http://www.rodsbooks.com/refind/bootmode.html#windows</a></li><li>Ubuntu 開機速度: <a href=https://kknews.cc/zh-tw/entertainment/8bn8ke.html>https://kknews.cc/zh-tw/entertainment/8bn8ke.html</a></li></ol></div><div class=post-footer></div></article></main></body></html>