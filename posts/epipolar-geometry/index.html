<!doctype html><html lang=en-us><head><title>對極幾何 Epipolar Geometry // Ptzu's blog</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.81.0"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Roger Lin"><meta name=description content><link rel=stylesheet href=https://ptzu.github.io/css/main.min.4a7ec8660f9a44b08c4da97c5f2e31b1192df1d4d0322e65c0dbbc6ecb1b863f.css><meta name=twitter:card content="summary"><meta name=twitter:title content="對極幾何 Epipolar Geometry"><meta name=twitter:description content="對於一個場景, 透過兩個位置不同的相機觀看 這兩幅圖像之間會有一些點對應關係 整張圖所形成的幾何關係稱為 Epipolar Gemometry 如下圖: 兩個相機中心分別為 {%math%} O_{1},\ O_{2} {%endmath%} 三維世界座標點 {%math%} P {%endmath%} 在兩個像平面 {%math%} A_{1},\ A_{2} {%endmath%} 投影的點為 {%math%} p_{1},\ p_{2} {%endmath%} 而 {%math%} P,\ O_{1}\ O_{2} {%endmath%} 三點所形成的平面稱為極平面(Epipolar plane) {%math%} O_{1}O_{2} {%endmath%}稱為基線(Baseline), 穿越兩個像平面的點分別為 {%math%} e_{1},\ e_{2} {%endmath%} 稱為極點(Epipoles) 投影點與極點連成的線稱為極線(Epipolar Line): {%math%} l_{1},\ l_{2} {%endmath%}
我們可以透過兩幀圖像之間的特徵點對應, 進而求出相機的運動
推導 設點三維做標點 {%math%} P=[X,Y,Z]^{T} {%endmath%} 對於兩個投影點 {%math%} s_{1}p_{1}=KP\s_{2}p_{2}=K(RP+t) {%endmath%} K 是內參矩陣 若是用齊次座標, 可以將 s 去除, 因為常數項不影響 接著我們覺得 K 有點麻煩, 所以我們用歸一化座標 {%math%} x_{1}=K^{-1}p_{1},\ x_{2}=K^{-1}p_{2} {%endmath%} 看公式可以知道這東西其實就是 P 而我們不想透過 K 來得到投影點座標 反而是直接假設有一個距離相機 z = 1 的平面 投影在上面的座標為: {%math%} P=\begin{bmatrix} \frac{X}{Z}\ \frac{Y}{Z}\ 1 \end{bmatrix} {%endmath%} 來得到二維座標 我們可以得到這樣的關係: {%math%} x_{2}=Rx_{1} + t {%endmath%} 接下來就是數學的一些變換: 兩邊同時乘上 {%math%} \hat{t} {%endmath%}, 相當於與 t 做外積 {%math%} \hat{t}x_{2}=\hat{t}Rx_{1} {%endmath%} 上面的 t 因為和自己做外積, 所以消失了 接著左乘 {%math%} x_{2}^{T} {%endmath%} 因為 {%math%} \hat{t}x_{2} {%endmath%} 是一個和 {%math%} t,\ x_{2} {%endmath%} 垂直的向量 再和{%math%} x_{2} {%endmath%} 做內積就會是 0 得到以下式子: {%math%} x_{2}^{T}\hat{t}Rx_{1} = 0 {%endmath%} 此式就稱為 對極約束(Epipolar Constraint) 代入 {%math%} p_{1}, p_{2} {%endmath%} {%math%} p_{2}^{T}K^{-T}\hat{t}RK^{-1}p_{1} = 0 {%endmath%} 幾何意義是 {%math%} P,\ O_{1},\ O_{2} {%endmath%} 共平面 將 {%math%} \hat{t}R {%endmath%} 令成 E, 這東西就稱為本質矩陣(Essential Matrix) 若是有包含內參, 就是基本矩陣(Fundamental Matrix) {%math%} E=\hat{t}R,\ F=K^{-T}EK^{-1} {%endmath%} 進一步簡化約束式: {%math%} x_{2}^{T}Ex_{1}=p_{2}^{T}Fp_{1}=0 {%endmath%}"><meta property="og:title" content="對極幾何 Epipolar Geometry"><meta property="og:description" content="對於一個場景, 透過兩個位置不同的相機觀看 這兩幅圖像之間會有一些點對應關係 整張圖所形成的幾何關係稱為 Epipolar Gemometry 如下圖: 兩個相機中心分別為 {%math%} O_{1},\ O_{2} {%endmath%} 三維世界座標點 {%math%} P {%endmath%} 在兩個像平面 {%math%} A_{1},\ A_{2} {%endmath%} 投影的點為 {%math%} p_{1},\ p_{2} {%endmath%} 而 {%math%} P,\ O_{1}\ O_{2} {%endmath%} 三點所形成的平面稱為極平面(Epipolar plane) {%math%} O_{1}O_{2} {%endmath%}稱為基線(Baseline), 穿越兩個像平面的點分別為 {%math%} e_{1},\ e_{2} {%endmath%} 稱為極點(Epipoles) 投影點與極點連成的線稱為極線(Epipolar Line): {%math%} l_{1},\ l_{2} {%endmath%}
我們可以透過兩幀圖像之間的特徵點對應, 進而求出相機的運動
推導 設點三維做標點 {%math%} P=[X,Y,Z]^{T} {%endmath%} 對於兩個投影點 {%math%} s_{1}p_{1}=KP\s_{2}p_{2}=K(RP+t) {%endmath%} K 是內參矩陣 若是用齊次座標, 可以將 s 去除, 因為常數項不影響 接著我們覺得 K 有點麻煩, 所以我們用歸一化座標 {%math%} x_{1}=K^{-1}p_{1},\ x_{2}=K^{-1}p_{2} {%endmath%} 看公式可以知道這東西其實就是 P 而我們不想透過 K 來得到投影點座標 反而是直接假設有一個距離相機 z = 1 的平面 投影在上面的座標為: {%math%} P=\begin{bmatrix} \frac{X}{Z}\ \frac{Y}{Z}\ 1 \end{bmatrix} {%endmath%} 來得到二維座標 我們可以得到這樣的關係: {%math%} x_{2}=Rx_{1} + t {%endmath%} 接下來就是數學的一些變換: 兩邊同時乘上 {%math%} \hat{t} {%endmath%}, 相當於與 t 做外積 {%math%} \hat{t}x_{2}=\hat{t}Rx_{1} {%endmath%} 上面的 t 因為和自己做外積, 所以消失了 接著左乘 {%math%} x_{2}^{T} {%endmath%} 因為 {%math%} \hat{t}x_{2} {%endmath%} 是一個和 {%math%} t,\ x_{2} {%endmath%} 垂直的向量 再和{%math%} x_{2} {%endmath%} 做內積就會是 0 得到以下式子: {%math%} x_{2}^{T}\hat{t}Rx_{1} = 0 {%endmath%} 此式就稱為 對極約束(Epipolar Constraint) 代入 {%math%} p_{1}, p_{2} {%endmath%} {%math%} p_{2}^{T}K^{-T}\hat{t}RK^{-1}p_{1} = 0 {%endmath%} 幾何意義是 {%math%} P,\ O_{1},\ O_{2} {%endmath%} 共平面 將 {%math%} \hat{t}R {%endmath%} 令成 E, 這東西就稱為本質矩陣(Essential Matrix) 若是有包含內參, 就是基本矩陣(Fundamental Matrix) {%math%} E=\hat{t}R,\ F=K^{-T}EK^{-1} {%endmath%} 進一步簡化約束式: {%math%} x_{2}^{T}Ex_{1}=p_{2}^{T}Fp_{1}=0 {%endmath%}"><meta property="og:type" content="article"><meta property="og:url" content="https://ptzu.github.io/posts/epipolar-geometry/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-09-24T10:40:17+00:00"><meta property="article:modified_time" content="2018-09-24T10:40:17+00:00"></head><body><header class=app-header><a href=https://ptzu.github.io/><img class=app-header-avatar src=https://i.imgur.com/I4wI7XV.jpg alt="Roger Lin"></a><h1>Ptzu's blog</h1><nav class=app-header-menu><a class=app-header-menu-item href=/>Home</a>
-
<a class=app-header-menu-item href=/tags/>Tags</a>
-
<a class=app-header-menu-item href=/about/>About</a></nav><p>Record of My Life.</p><div class=app-header-social><a href=https://github.com/ptzu target=_blank rel="noreferrer noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>My Github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>對極幾何 Epipolar Geometry</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Sep 24, 2018</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>2 min read</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://ptzu.github.io/tags/codeforces/>Codeforces</a></div></div></header><div class=post-content><p>對於一個場景, 透過兩個位置不同的相機觀看
這兩幅圖像之間會有一些點對應關係
整張圖所形成的幾何關係稱為 Epipolar Gemometry
如下圖:
<img src=https://i.imgur.com/Z61FHfJ.png alt></p><p>兩個相機中心分別為 {%math%} O_{1},\ O_{2} {%endmath%}
三維世界座標點 {%math%} P {%endmath%}
在兩個像平面 {%math%} A_{1},\ A_{2} {%endmath%} 投影的點為 {%math%} p_{1},\ p_{2} {%endmath%}
而 {%math%} P,\ O_{1}\ O_{2} {%endmath%} 三點所形成的平面稱為極平面(Epipolar plane)
{%math%} O_{1}O_{2} {%endmath%}稱為基線(Baseline), 穿越兩個像平面的點分別為 {%math%} e_{1},\ e_{2} {%endmath%} 稱為極點(Epipoles)
投影點與極點連成的線稱為極線(Epipolar Line): {%math%} l_{1},\ l_{2} {%endmath%}</p><p>我們可以透過兩幀圖像之間的特徵點對應, 進而求出相機的運動</p><h1 id=推導>推導</h1><p>設點三維做標點
{%math%} P=[X,Y,Z]^{T} {%endmath%}
對於兩個投影點
{%math%} s_{1}p_{1}=KP\s_{2}p_{2}=K(RP+t) {%endmath%}
K 是內參矩陣
若是用齊次座標, 可以將 s 去除, 因為常數項不影響
接著我們覺得 K 有點麻煩, 所以我們用<a href=https://zhuanlan.zhihu.com/p/33583981>歸一化座標</a>
{%math%} x_{1}=K^{-1}p_{1},\ x_{2}=K^{-1}p_{2} {%endmath%}
看公式可以知道這東西其實就是 P
而我們不想透過 K 來得到投影點座標
反而是直接假設有一個距離相機 z = 1 的平面
投影在上面的座標為:
{%math%} P=\begin{bmatrix}
\frac{X}{Z}\
\frac{Y}{Z}\
1
\end{bmatrix} {%endmath%}
來得到二維座標
我們可以得到這樣的關係:
{%math%} x_{2}=Rx_{1} + t {%endmath%}
接下來就是數學的一些變換:
兩邊同時乘上 {%math%} \hat{t} {%endmath%}, 相當於與 t 做外積
{%math%} \hat{t}x_{2}=\hat{t}Rx_{1} {%endmath%}
上面的 t 因為和自己做外積, 所以消失了
接著左乘 {%math%} x_{2}^{T} {%endmath%}
因為 {%math%} \hat{t}x_{2} {%endmath%} 是一個和 {%math%} t,\ x_{2} {%endmath%} 垂直的向量
再和{%math%} x_{2} {%endmath%} 做內積就會是 0
得到以下式子:
{%math%} x_{2}^{T}\hat{t}Rx_{1} = 0 {%endmath%}
此式就稱為 對極約束(Epipolar Constraint)
代入 {%math%} p_{1}, p_{2} {%endmath%}
{%math%} p_{2}^{T}K^{-T}\hat{t}RK^{-1}p_{1} = 0 {%endmath%}
幾何意義是 {%math%} P,\ O_{1},\ O_{2} {%endmath%} 共平面
將 {%math%} \hat{t}R {%endmath%} 令成 E, 這東西就稱為本質矩陣(Essential Matrix)
若是有包含內參, 就是基本矩陣(Fundamental Matrix)
{%math%} E=\hat{t}R,\ F=K^{-T}EK^{-1} {%endmath%}
進一步簡化約束式:
{%math%} x_{2}^{T}Ex_{1}=p_{2}^{T}Fp_{1}=0 {%endmath%}</p><p>到這邊我們可以得到一個和 x 有關的式子
可以藉由配對點對來求得 E 或 F
再根據 E 或 F 取得 R, t
以上推導來自高翔.</p><h1 id=延伸>延伸</h1><p>由於約束式的幾何意義是三點共面
所以有這樣的式子:
{%math%} (P - p_{1})[(O_{1}-O_{2})\times (P - p_{2})]=0 {%endmath%}
我想從這個推回去約束式, 不過一直沒有成功QQ
時間關係只好先擱著</p><p>而基本矩陣有一些基本特性:</p><ol><li>rank = 2</li><li>自由度為 5</li></ol><p>可以參考<a href="https://www.youtube.com/watch?v=DgGV3l82NTk">這首歌</a>ＸＤ</p><h1 id=參考>參考</h1><ol><li><a href=https://www.zhihu.com/question/51510464>相机位姿求解问题？</a></li><li><a href=https://www.zhihu.com/question/27581884>本质矩阵和基础矩阵的区别是什么？</a></li><li><a href=http://silverwind1982.pixnet.net/blog/post/153221294-pinhole-camera%3A-epipolar-geometry>Pinhole Camera: Epipolar Geometry(感覺推導有些問題)</a></li><li><a href=http://www.cs.toronto.edu/~jepson/csc420/notes/epiPolarGeom.pdf>Epipolar Geometry</a></li></ol></div><div class=post-footer></div></article></main></body></html>